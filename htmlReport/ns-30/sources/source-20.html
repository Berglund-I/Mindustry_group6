


<!DOCTYPE html>
<html id="htmlId">
<head>
  <title>Coverage Report > ResearchDialog</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">mindustry.ui.dialogs</a>
</div>

<h1>Coverage Summary for Class: ResearchDialog (mindustry.ui.dialogs)</h1>

<table class="coverageStats">

<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">ResearchDialog</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/19)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/123)
  </span>
</td>
</tr>
  <tr>
    <td class="name">ResearchDialog$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/4)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/13)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">ResearchDialog$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/7)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">ResearchDialog$3</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/4)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/11)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">ResearchDialog$4</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/4)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/24)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">ResearchDialog$5</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">ResearchDialog$6</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">ResearchDialog$LayoutNode</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/6)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">ResearchDialog$TechTreeNode</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/9)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">ResearchDialog$View</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/21)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/205)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">ResearchDialog$View$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/4)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">ResearchDialog$View$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/7)
  </span>
</td>
  </tr>
<tr>
  <td class="name"><strong>Total</strong></td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/62)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/415)
  </span>
</td>
</tr>
</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;package mindustry.ui.dialogs;
&nbsp;
&nbsp;import arc.*;
&nbsp;import arc.graphics.*;
&nbsp;import arc.graphics.g2d.*;
&nbsp;import arc.input.*;
&nbsp;import arc.math.*;
&nbsp;import arc.math.geom.*;
&nbsp;import arc.scene.*;
&nbsp;import arc.scene.actions.*;
&nbsp;import arc.scene.event.*;
&nbsp;import arc.scene.style.*;
&nbsp;import arc.scene.ui.*;
&nbsp;import arc.scene.ui.TextButton.*;
&nbsp;import arc.scene.ui.layout.*;
&nbsp;import arc.struct.*;
&nbsp;import arc.util.*;
&nbsp;import mindustry.content.*;
&nbsp;import mindustry.content.TechTree.*;
&nbsp;import mindustry.core.*;
&nbsp;import mindustry.game.EventType.*;
&nbsp;import mindustry.game.Objectives.*;
&nbsp;import mindustry.gen.*;
&nbsp;import mindustry.graphics.*;
&nbsp;import mindustry.input.*;
&nbsp;import mindustry.type.*;
&nbsp;import mindustry.ui.*;
&nbsp;import mindustry.ui.layout.*;
&nbsp;import mindustry.ui.layout.TreeLayout.*;
&nbsp;
&nbsp;import java.util.*;
&nbsp;
&nbsp;import static mindustry.Vars.*;
&nbsp;import static mindustry.gen.Tex.*;
&nbsp;
&nbsp;public class ResearchDialog extends BaseDialog{
<b class="nc">&nbsp;    public static boolean debugShowRequirements = false;</b>
&nbsp;
<b class="nc">&nbsp;    public final float nodeSize = Scl.scl(60f);</b>
<b class="nc">&nbsp;    public ObjectSet&lt;TechTreeNode&gt; nodes = new ObjectSet&lt;&gt;();</b>
<b class="nc">&nbsp;    public TechTreeNode root = new TechTreeNode(TechTree.roots.first(), null);</b>
<b class="nc">&nbsp;    public TechNode lastNode = root.node;</b>
<b class="nc">&nbsp;    public Rect bounds = new Rect();</b>
&nbsp;    public ItemsDisplay itemDisplay;
&nbsp;    public View view;
&nbsp;
&nbsp;    public ItemSeq items;
&nbsp;
&nbsp;    private boolean showTechSelect;
&nbsp;
&nbsp;    public ResearchDialog(){
<b class="nc">&nbsp;        super(&quot;&quot;);</b>
&nbsp;
<b class="nc">&nbsp;        titleTable.remove();</b>
<b class="nc">&nbsp;        titleTable.clear();</b>
<b class="nc">&nbsp;        titleTable.top();</b>
<b class="nc">&nbsp;        titleTable.button(b -&gt; {</b>
&nbsp;            //TODO custom icon here.
<b class="nc">&nbsp;            b.imageDraw(() -&gt; root.node.icon()).padRight(8).size(iconMed);</b>
<b class="nc">&nbsp;            b.add().growX();</b>
<b class="nc">&nbsp;            b.label(() -&gt; root.node.localizedName()).color(Pal.accent);</b>
<b class="nc">&nbsp;            b.add().growX();</b>
<b class="nc">&nbsp;            b.add().size(iconMed);</b>
&nbsp;        }, () -&gt; {
<b class="nc">&nbsp;            new BaseDialog(&quot;@techtree.select&quot;){{</b>
<b class="nc">&nbsp;                cont.pane(t -&gt; {</b>
<b class="nc">&nbsp;                    t.table(Tex.button, in -&gt; {</b>
<b class="nc">&nbsp;                        in.defaults().width(300f).height(60f);</b>
<b class="nc">&nbsp;                        for(TechNode node : TechTree.roots){</b>
<b class="nc">&nbsp;                            if(node.requiresUnlock &amp;&amp; !node.content.unlocked() &amp;&amp; node != getPrefRoot()) continue;</b>
&nbsp;
&nbsp;                            //TODO toggle
<b class="nc">&nbsp;                            in.button(node.localizedName(), node.icon(), Styles.flatTogglet, iconMed, () -&gt; {</b>
<b class="nc">&nbsp;                                if(node == lastNode){</b>
&nbsp;                                    return;
&nbsp;                                }
&nbsp;
<b class="nc">&nbsp;                                rebuildTree(node);</b>
<b class="nc">&nbsp;                                hide();</b>
<b class="nc">&nbsp;                            }).marginLeft(12f).checked(node == lastNode).row();</b>
<b class="nc">&nbsp;                        }</b>
&nbsp;                    });
&nbsp;                });
&nbsp;
<b class="nc">&nbsp;                addCloseButton();</b>
<b class="nc">&nbsp;            }}.show();</b>
<b class="nc">&nbsp;        }).visible(() -&gt; showTechSelect = TechTree.roots.count(node -&gt; !(node.requiresUnlock &amp;&amp; !node.content.unlocked())) &gt; 1).minWidth(300f);</b>
&nbsp;
<b class="nc">&nbsp;        margin(0f).marginBottom(8);</b>
<b class="nc">&nbsp;        cont.stack(titleTable, view = new View(), itemDisplay = new ItemsDisplay()).grow();</b>
&nbsp;
<b class="nc">&nbsp;        titleTable.toFront();</b>
&nbsp;
<b class="nc">&nbsp;        shouldPause = true;</b>
&nbsp;
<b class="nc">&nbsp;        onResize(this::checkMargin);</b>
&nbsp;
<b class="nc">&nbsp;        shown(() -&gt; {</b>
<b class="nc">&nbsp;            checkMargin();</b>
<b class="nc">&nbsp;            Core.app.post(this::checkMargin);</b>
&nbsp;
<b class="nc">&nbsp;            Planet currPlanet = ui.planet.isShown() ?</b>
<b class="nc">&nbsp;                ui.planet.state.planet :</b>
<b class="nc">&nbsp;                state.isCampaign() ? state.rules.sector.planet : null;</b>
&nbsp;
<b class="nc">&nbsp;            if(currPlanet != null &amp;&amp; currPlanet.techTree != null){</b>
<b class="nc">&nbsp;                switchTree(currPlanet.techTree);</b>
&nbsp;            }
<b class="nc">&nbsp;            rebuildItems();</b>
&nbsp;
<b class="nc">&nbsp;            checkNodes(root);</b>
<b class="nc">&nbsp;            treeLayout();</b>
&nbsp;
<b class="nc">&nbsp;            view.hoverNode = null;</b>
<b class="nc">&nbsp;            view.infoTable.remove();</b>
<b class="nc">&nbsp;            view.infoTable.clear();</b>
&nbsp;        });
&nbsp;
<b class="nc">&nbsp;        hidden(ui.planet::setup);</b>
&nbsp;
<b class="nc">&nbsp;        addCloseButton();</b>
&nbsp;
<b class="nc">&nbsp;        keyDown(key -&gt; {</b>
<b class="nc">&nbsp;            if(key == Core.keybinds.get(Binding.research).key){</b>
<b class="nc">&nbsp;                Core.app.post(this::hide);</b>
&nbsp;            }
&nbsp;        });
&nbsp;
<b class="nc">&nbsp;        buttons.button(&quot;@database&quot;, Icon.book, () -&gt; {</b>
<b class="nc">&nbsp;            hide();</b>
<b class="nc">&nbsp;            ui.database.show();</b>
<b class="nc">&nbsp;        }).size(210f, 64f).name(&quot;database&quot;);</b>
&nbsp;
&nbsp;        //scaling/drag input
<b class="nc">&nbsp;        addListener(new InputListener(){</b>
&nbsp;            @Override
&nbsp;            public boolean scrolled(InputEvent event, float x, float y, float amountX, float amountY){
<b class="nc">&nbsp;                view.setScale(Mathf.clamp(view.scaleX - amountY / 10f * view.scaleX, 0.25f, 1f));</b>
<b class="nc">&nbsp;                view.setOrigin(Align.center);</b>
<b class="nc">&nbsp;                view.setTransform(true);</b>
<b class="nc">&nbsp;                return true;</b>
&nbsp;            }
&nbsp;
&nbsp;            @Override
&nbsp;            public boolean mouseMoved(InputEvent event, float x, float y){
<b class="nc">&nbsp;                view.requestScroll();</b>
<b class="nc">&nbsp;                return super.mouseMoved(event, x, y);</b>
&nbsp;            }
&nbsp;        });
&nbsp;
<b class="nc">&nbsp;        touchable = Touchable.enabled;</b>
&nbsp;
<b class="nc">&nbsp;        addCaptureListener(new ElementGestureListener(){</b>
&nbsp;            @Override
&nbsp;            public void zoom(InputEvent event, float initialDistance, float distance){
<b class="nc">&nbsp;                if(view.lastZoom &lt; 0){</b>
<b class="nc">&nbsp;                    view.lastZoom = view.scaleX;</b>
&nbsp;                }
&nbsp;
<b class="nc">&nbsp;                view.setScale(Mathf.clamp(distance / initialDistance * view.lastZoom, 0.25f, 1f));</b>
<b class="nc">&nbsp;                view.setOrigin(Align.center);</b>
<b class="nc">&nbsp;                view.setTransform(true);</b>
&nbsp;            }
&nbsp;
&nbsp;            @Override
&nbsp;            public void touchUp(InputEvent event, float x, float y, int pointer, KeyCode button){
<b class="nc">&nbsp;                view.lastZoom = view.scaleX;</b>
&nbsp;            }
&nbsp;
&nbsp;            @Override
&nbsp;            public void pan(InputEvent event, float x, float y, float deltaX, float deltaY){
<b class="nc">&nbsp;                view.panX += deltaX / view.scaleX;</b>
<b class="nc">&nbsp;                view.panY += deltaY / view.scaleY;</b>
<b class="nc">&nbsp;                view.moved = true;</b>
<b class="nc">&nbsp;                view.clamp();</b>
&nbsp;            }
&nbsp;        });
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public Dialog show(){
<b class="nc">&nbsp;        if(net.client()){</b>
<b class="nc">&nbsp;            ui.showInfo(&quot;@research.multiplayer&quot;);</b>
<b class="nc">&nbsp;            return this;</b>
&nbsp;        }
<b class="nc">&nbsp;        return show(Core.scene);</b>
&nbsp;    }
&nbsp;
&nbsp;    void checkMargin(){
<b class="nc">&nbsp;        if(Core.graphics.isPortrait() &amp;&amp; showTechSelect){</b>
<b class="nc">&nbsp;            itemDisplay.marginTop(60f);</b>
&nbsp;        }else{
<b class="nc">&nbsp;            itemDisplay.marginTop(0f);</b>
&nbsp;        }
<b class="nc">&nbsp;        itemDisplay.invalidate();</b>
<b class="nc">&nbsp;        itemDisplay.layout();</b>
&nbsp;    }
&nbsp;
&nbsp;    public void rebuildItems(){
<b class="nc">&nbsp;        items = new ItemSeq(){</b>
&nbsp;            //store sector item amounts for modifications
<b class="nc">&nbsp;            ObjectMap&lt;Sector, ItemSeq&gt; cache = new ObjectMap&lt;&gt;();</b>
&nbsp;
&nbsp;            {
&nbsp;                //first, find a planet associated with the current tech tree
<b class="nc">&nbsp;                Planet rootPlanet = lastNode.planet != null ? lastNode.planet : content.planets().find(p -&gt; p.techTree == lastNode);</b>
&nbsp;
&nbsp;                //if there is no root, fall back to serpulo
<b class="nc">&nbsp;                if(rootPlanet == null) rootPlanet = Planets.serpulo;</b>
&nbsp;
&nbsp;                //add global counts of each sector
<b class="nc">&nbsp;                for(Sector sector : rootPlanet.sectors){</b>
<b class="nc">&nbsp;                    if(sector.hasBase()){</b>
<b class="nc">&nbsp;                        ItemSeq cached = sector.items();</b>
<b class="nc">&nbsp;                        cache.put(sector, cached);</b>
<b class="nc">&nbsp;                        cached.each((item, amount) -&gt; {</b>
<b class="nc">&nbsp;                            values[item.id] += Math.max(amount, 0);</b>
<b class="nc">&nbsp;                            total += Math.max(amount, 0);</b>
&nbsp;                        });
&nbsp;                    }
<b class="nc">&nbsp;                }</b>
&nbsp;            }
&nbsp;
&nbsp;            //this is the only method that actually modifies the sequence itself.
&nbsp;            @Override
&nbsp;            public void add(Item item, int amount){
&nbsp;                //only have custom removal logic for when the sequence gets items taken out of it (e.g. research)
<b class="nc">&nbsp;                if(amount &lt; 0){</b>
&nbsp;                    //remove items from each sector&#39;s storage, one by one
&nbsp;
&nbsp;                    //negate amount since it&#39;s being *removed* - this makes it positive
<b class="nc">&nbsp;                    amount = -amount;</b>
&nbsp;
&nbsp;                    //% that gets removed from each sector
<b class="nc">&nbsp;                    double percentage = (double)amount / get(item);</b>
<b class="nc">&nbsp;                    int[] counter = {amount};</b>
<b class="nc">&nbsp;                    cache.each((sector, seq) -&gt; {</b>
<b class="nc">&nbsp;                        if(counter[0] == 0) return;</b>
&nbsp;
&nbsp;                        //amount that will be removed
<b class="nc">&nbsp;                        int toRemove = Math.min((int)Math.ceil(percentage * seq.get(item)), counter[0]);</b>
&nbsp;
&nbsp;                        //actually remove it from the sector
<b class="nc">&nbsp;                        sector.removeItem(item, toRemove);</b>
<b class="nc">&nbsp;                        seq.remove(item, toRemove);</b>
&nbsp;
<b class="nc">&nbsp;                        counter[0] -= toRemove;</b>
&nbsp;                    });
&nbsp;
&nbsp;                    //negate again to display correct number
<b class="nc">&nbsp;                    amount = -amount;</b>
&nbsp;                }
&nbsp;
<b class="nc">&nbsp;                super.add(item, amount);</b>
&nbsp;            }
&nbsp;        };
&nbsp;
<b class="nc">&nbsp;        itemDisplay.rebuild(items);</b>
&nbsp;    }
&nbsp;
&nbsp;    public @Nullable TechNode getPrefRoot(){
<b class="nc">&nbsp;        Planet currPlanet = ui.planet.isShown() ?</b>
<b class="nc">&nbsp;            ui.planet.state.planet :</b>
<b class="nc">&nbsp;            state.isCampaign() ? state.rules.sector.planet : null;</b>
<b class="nc">&nbsp;        return currPlanet == null ? null : currPlanet.techTree;</b>
&nbsp;    }
&nbsp;
&nbsp;    public void switchTree(TechNode node){
<b class="nc">&nbsp;        if(lastNode == node || node == null) return;</b>
<b class="nc">&nbsp;        nodes.clear();</b>
<b class="nc">&nbsp;        root = new TechTreeNode(node, null);</b>
<b class="nc">&nbsp;        lastNode = node;</b>
<b class="nc">&nbsp;        view.rebuildAll();</b>
&nbsp;
<b class="nc">&nbsp;        rebuildItems();</b>
&nbsp;    }
&nbsp;
&nbsp;    public void rebuildTree(TechNode node){
<b class="nc">&nbsp;        switchTree(node);</b>
<b class="nc">&nbsp;        view.panX = 0f;</b>
<b class="nc">&nbsp;        view.panY = -200f;</b>
<b class="nc">&nbsp;        view.setScale(1f);</b>
&nbsp;
<b class="nc">&nbsp;        view.hoverNode = null;</b>
<b class="nc">&nbsp;        view.infoTable.remove();</b>
<b class="nc">&nbsp;        view.infoTable.clear();</b>
&nbsp;
<b class="nc">&nbsp;        checkNodes(root);</b>
<b class="nc">&nbsp;        treeLayout();</b>
&nbsp;    }
&nbsp;
&nbsp;    void treeLayout(){
<b class="nc">&nbsp;        float spacing = 20f;</b>
<b class="nc">&nbsp;        LayoutNode node = new LayoutNode(root, null);</b>
<b class="nc">&nbsp;        LayoutNode[] children = node.children;</b>
<b class="nc">&nbsp;        LayoutNode[] leftHalf = Arrays.copyOfRange(node.children, 0, Mathf.ceil(node.children.length/2f));</b>
<b class="nc">&nbsp;        LayoutNode[] rightHalf = Arrays.copyOfRange(node.children, Mathf.ceil(node.children.length/2f), node.children.length);</b>
&nbsp;
<b class="nc">&nbsp;        node.children = leftHalf;</b>
<b class="nc">&nbsp;        new BranchTreeLayout(){{</b>
<b class="nc">&nbsp;            gapBetweenLevels = gapBetweenNodes = spacing;</b>
<b class="nc">&nbsp;            rootLocation = TreeLocation.top;</b>
<b class="nc">&nbsp;        }}.layout(node);</b>
&nbsp;
<b class="nc">&nbsp;        float lastY = node.y;</b>
&nbsp;
<b class="nc">&nbsp;        if(rightHalf.length &gt; 0){</b>
&nbsp;
<b class="nc">&nbsp;            node.children = rightHalf;</b>
<b class="nc">&nbsp;            new BranchTreeLayout(){{</b>
<b class="nc">&nbsp;                gapBetweenLevels = gapBetweenNodes = spacing;</b>
<b class="nc">&nbsp;                rootLocation = TreeLocation.bottom;</b>
<b class="nc">&nbsp;            }}.layout(node);</b>
&nbsp;
<b class="nc">&nbsp;            shift(leftHalf, node.y - lastY);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        node.children = children;</b>
&nbsp;
<b class="nc">&nbsp;        float minx = 0f, miny = 0f, maxx = 0f, maxy = 0f;</b>
<b class="nc">&nbsp;        copyInfo(node);</b>
&nbsp;
<b class="nc">&nbsp;        for(TechTreeNode n : nodes){</b>
<b class="nc">&nbsp;            if(!n.visible) continue;</b>
<b class="nc">&nbsp;            minx = Math.min(n.x - n.width/2f, minx);</b>
<b class="nc">&nbsp;            maxx = Math.max(n.x + n.width/2f, maxx);</b>
<b class="nc">&nbsp;            miny = Math.min(n.y - n.height/2f, miny);</b>
<b class="nc">&nbsp;            maxy = Math.max(n.y + n.height/2f, maxy);</b>
<b class="nc">&nbsp;        }</b>
<b class="nc">&nbsp;        bounds = new Rect(minx, miny, maxx - minx, maxy - miny);</b>
<b class="nc">&nbsp;        bounds.y += nodeSize*1.5f;</b>
&nbsp;    }
&nbsp;
&nbsp;    void shift(LayoutNode[] children, float amount){
<b class="nc">&nbsp;        for(LayoutNode node : children){</b>
<b class="nc">&nbsp;            node.y += amount;</b>
<b class="nc">&nbsp;            if(node.children != null &amp;&amp; node.children.length &gt; 0) shift(node.children, amount);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    void copyInfo(LayoutNode node){
<b class="nc">&nbsp;        node.node.x = node.x;</b>
<b class="nc">&nbsp;        node.node.y = node.y;</b>
<b class="nc">&nbsp;        if(node.children != null){</b>
<b class="nc">&nbsp;            for(LayoutNode child : node.children){</b>
<b class="nc">&nbsp;                copyInfo(child);</b>
&nbsp;            }
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    void checkNodes(TechTreeNode node){
<b class="nc">&nbsp;        boolean locked = locked(node.node);</b>
<b class="nc">&nbsp;        if(!locked &amp;&amp; (node.parent == null || node.parent.visible)) node.visible = true;</b>
<b class="nc">&nbsp;        node.selectable = selectable(node.node);</b>
<b class="nc">&nbsp;        for(TechTreeNode l : node.children){</b>
<b class="nc">&nbsp;            l.visible = !locked &amp;&amp; l.parent.visible;</b>
<b class="nc">&nbsp;            checkNodes(l);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        itemDisplay.rebuild(items);</b>
&nbsp;    }
&nbsp;
&nbsp;    boolean selectable(TechNode node){
<b class="nc">&nbsp;        return node.content.unlocked() || !node.objectives.contains(i -&gt; !i.complete());</b>
&nbsp;    }
&nbsp;
&nbsp;    boolean locked(TechNode node){
<b class="nc">&nbsp;        return node.content.locked();</b>
&nbsp;    }
&nbsp;
&nbsp;    class LayoutNode extends TreeNode&lt;LayoutNode&gt;{
&nbsp;        final TechTreeNode node;
&nbsp;
<b class="nc">&nbsp;        LayoutNode(TechTreeNode node, LayoutNode parent){</b>
<b class="nc">&nbsp;            this.node = node;</b>
<b class="nc">&nbsp;            this.parent = parent;</b>
<b class="nc">&nbsp;            this.width = this.height = nodeSize;</b>
<b class="nc">&nbsp;            if(node.children != null){</b>
<b class="nc">&nbsp;                children = Seq.with(node.children).map(t -&gt; new LayoutNode(t, this)).toArray(LayoutNode.class);</b>
&nbsp;            }
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    public class TechTreeNode extends TreeNode&lt;TechTreeNode&gt;{
&nbsp;        public final TechNode node;
<b class="nc">&nbsp;        public boolean visible = true, selectable = true;</b>
&nbsp;
<b class="nc">&nbsp;        public TechTreeNode(TechNode node, TechTreeNode parent){</b>
<b class="nc">&nbsp;            this.node = node;</b>
<b class="nc">&nbsp;            this.parent = parent;</b>
<b class="nc">&nbsp;            this.width = this.height = nodeSize;</b>
<b class="nc">&nbsp;            nodes.add(this);</b>
<b class="nc">&nbsp;            children = new TechTreeNode[node.children.size];</b>
<b class="nc">&nbsp;            for(int i = 0; i &lt; children.length; i++){</b>
<b class="nc">&nbsp;                children[i] = new TechTreeNode(node.children.get(i), this);</b>
&nbsp;            }
&nbsp;        }
&nbsp;    }
&nbsp;
<b class="nc">&nbsp;    public class View extends Group{</b>
<b class="nc">&nbsp;        public float panX = 0, panY = -200, lastZoom = -1;</b>
<b class="nc">&nbsp;        public boolean moved = false;</b>
&nbsp;        public ImageButton hoverNode;
<b class="nc">&nbsp;        public Table infoTable = new Table();</b>
&nbsp;
&nbsp;        {
<b class="nc">&nbsp;            rebuildAll();</b>
&nbsp;        }
&nbsp;
&nbsp;        public void rebuildAll(){
<b class="nc">&nbsp;            clear();</b>
<b class="nc">&nbsp;            hoverNode = null;</b>
<b class="nc">&nbsp;            infoTable.clear();</b>
<b class="nc">&nbsp;            infoTable.touchable = Touchable.enabled;</b>
&nbsp;
<b class="nc">&nbsp;            for(TechTreeNode node : nodes){</b>
<b class="nc">&nbsp;                ImageButton button = new ImageButton(node.node.content.uiIcon, Styles.nodei);</b>
<b class="nc">&nbsp;                button.resizeImage(32f);</b>
<b class="nc">&nbsp;                button.getImage().setScaling(Scaling.fit);</b>
<b class="nc">&nbsp;                button.visible(() -&gt; node.visible);</b>
<b class="nc">&nbsp;                button.clicked(() -&gt; {</b>
<b class="nc">&nbsp;                    if(moved) return;</b>
&nbsp;
<b class="nc">&nbsp;                    if(mobile){</b>
<b class="nc">&nbsp;                        hoverNode = button;</b>
<b class="nc">&nbsp;                        rebuild();</b>
<b class="nc">&nbsp;                        float right = infoTable.getRight();</b>
<b class="nc">&nbsp;                        if(right &gt; Core.graphics.getWidth()){</b>
<b class="nc">&nbsp;                            float moveBy = right - Core.graphics.getWidth();</b>
<b class="nc">&nbsp;                            addAction(new RelativeTemporalAction(){</b>
&nbsp;                                {
<b class="nc">&nbsp;                                    setDuration(0.1f);</b>
<b class="nc">&nbsp;                                    setInterpolation(Interp.fade);</b>
&nbsp;                                }
&nbsp;
&nbsp;                                @Override
&nbsp;                                protected void updateRelative(float percentDelta){
<b class="nc">&nbsp;                                    panX -= moveBy * percentDelta;</b>
&nbsp;                                }
&nbsp;                            });
&nbsp;                        }
<b class="nc">&nbsp;                    }else if(canSpend(node.node) &amp;&amp; locked(node.node)){</b>
<b class="nc">&nbsp;                        spend(node.node);</b>
&nbsp;                    }
&nbsp;                });
<b class="nc">&nbsp;                button.hovered(() -&gt; {</b>
<b class="nc">&nbsp;                    if(!mobile &amp;&amp; hoverNode != button &amp;&amp; node.visible){</b>
<b class="nc">&nbsp;                        hoverNode = button;</b>
<b class="nc">&nbsp;                        rebuild();</b>
&nbsp;                    }
&nbsp;                });
<b class="nc">&nbsp;                button.exited(() -&gt; {</b>
<b class="nc">&nbsp;                    if(!mobile &amp;&amp; hoverNode == button &amp;&amp; !infoTable.hasMouse() &amp;&amp; !hoverNode.hasMouse()){</b>
<b class="nc">&nbsp;                        hoverNode = null;</b>
<b class="nc">&nbsp;                        rebuild();</b>
&nbsp;                    }
&nbsp;                });
<b class="nc">&nbsp;                button.touchable(() -&gt; !node.visible ? Touchable.disabled : Touchable.enabled);</b>
<b class="nc">&nbsp;                button.userObject = node.node;</b>
<b class="nc">&nbsp;                button.setSize(nodeSize);</b>
<b class="nc">&nbsp;                button.update(() -&gt; {</b>
<b class="nc">&nbsp;                    float offset = (Core.graphics.getHeight() % 2) / 2f;</b>
<b class="nc">&nbsp;                    button.setPosition(node.x + panX + width / 2f, node.y + panY + height / 2f + offset, Align.center);</b>
<b class="nc">&nbsp;                    button.getStyle().up = !locked(node.node) ? Tex.buttonOver : !selectable(node.node) || !canSpend(node.node) ? Tex.buttonRed : Tex.button;</b>
&nbsp;
<b class="nc">&nbsp;                    ((TextureRegionDrawable)button.getStyle().imageUp).setRegion(node.selectable ? node.node.content.uiIcon : Icon.lock.getRegion());</b>
<b class="nc">&nbsp;                    button.getImage().setColor(!locked(node.node) ? Color.white : node.selectable ? Color.gray : Pal.gray);</b>
<b class="nc">&nbsp;                    button.getImage().layout();</b>
&nbsp;                });
<b class="nc">&nbsp;                addChild(button);</b>
<b class="nc">&nbsp;            }</b>
&nbsp;
<b class="nc">&nbsp;            if(mobile){</b>
<b class="nc">&nbsp;                tapped(() -&gt; {</b>
<b class="nc">&nbsp;                    Element e = Core.scene.getHoverElement();</b>
<b class="nc">&nbsp;                    if(e == this){</b>
<b class="nc">&nbsp;                        hoverNode = null;</b>
<b class="nc">&nbsp;                        rebuild();</b>
&nbsp;                    }
&nbsp;                });
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            setOrigin(Align.center);</b>
<b class="nc">&nbsp;            setTransform(true);</b>
<b class="nc">&nbsp;            released(() -&gt; moved = false);</b>
&nbsp;        }
&nbsp;
&nbsp;        void clamp(){
<b class="nc">&nbsp;            float pad = nodeSize;</b>
&nbsp;
<b class="nc">&nbsp;            float ox = width/2f, oy = height/2f;</b>
<b class="nc">&nbsp;            float rx = bounds.x + panX + ox, ry = panY + oy + bounds.y;</b>
<b class="nc">&nbsp;            float rw = bounds.width, rh = bounds.height;</b>
<b class="nc">&nbsp;            rx = Mathf.clamp(rx, -rw + pad, Core.graphics.getWidth() - pad);</b>
<b class="nc">&nbsp;            ry = Mathf.clamp(ry, -rh + pad, Core.graphics.getHeight() - pad);</b>
<b class="nc">&nbsp;            panX = rx - bounds.x - ox;</b>
<b class="nc">&nbsp;            panY = ry - bounds.y - oy;</b>
&nbsp;        }
&nbsp;
&nbsp;        boolean canSpend(TechNode node){
<b class="nc">&nbsp;            if(!selectable(node)) return false;</b>
&nbsp;
<b class="nc">&nbsp;            if(node.requirements.length == 0) return true;</b>
&nbsp;
&nbsp;            //can spend when there&#39;s at least 1 item that can be spent (non complete)
<b class="nc">&nbsp;            for(int i = 0; i &lt; node.requirements.length; i++){</b>
<b class="nc">&nbsp;                if(node.finishedRequirements[i].amount &lt; node.requirements[i].amount &amp;&amp; items.has(node.requirements[i].item)){</b>
<b class="nc">&nbsp;                    return true;</b>
&nbsp;                }
&nbsp;            }
&nbsp;
&nbsp;            //can always spend when locked
<b class="nc">&nbsp;            return node.content.locked();</b>
&nbsp;        }
&nbsp;
&nbsp;        void spend(TechNode node){
<b class="nc">&nbsp;            boolean complete = true;</b>
&nbsp;
<b class="nc">&nbsp;            boolean[] shine = new boolean[node.requirements.length];</b>
<b class="nc">&nbsp;            boolean[] usedShine = new boolean[content.items().size];</b>
&nbsp;
<b class="nc">&nbsp;            for(int i = 0; i &lt; node.requirements.length; i++){</b>
<b class="nc">&nbsp;                ItemStack req = node.requirements[i];</b>
<b class="nc">&nbsp;                ItemStack completed = node.finishedRequirements[i];</b>
&nbsp;
&nbsp;                //amount actually taken from inventory
<b class="nc">&nbsp;                int used = Math.max(Math.min(req.amount - completed.amount, items.get(req.item)), 0);</b>
<b class="nc">&nbsp;                items.remove(req.item, used);</b>
<b class="nc">&nbsp;                completed.amount += used;</b>
&nbsp;
<b class="nc">&nbsp;                if(used &gt; 0){</b>
<b class="nc">&nbsp;                    shine[i] = true;</b>
<b class="nc">&nbsp;                    usedShine[req.item.id] = true;</b>
&nbsp;                }
&nbsp;
&nbsp;                //disable completion if the completed amount has not reached requirements
<b class="nc">&nbsp;                if(completed.amount &lt; req.amount){</b>
<b class="nc">&nbsp;                    complete = false;</b>
&nbsp;                }
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if(complete){</b>
<b class="nc">&nbsp;                unlock(node);</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            node.save();</b>
&nbsp;
&nbsp;            //??????
<b class="nc">&nbsp;            Core.scene.act();</b>
<b class="nc">&nbsp;            rebuild(shine);</b>
<b class="nc">&nbsp;            itemDisplay.rebuild(items, usedShine);</b>
&nbsp;        }
&nbsp;
&nbsp;        void unlock(TechNode node){
<b class="nc">&nbsp;            node.content.unlock();</b>
&nbsp;
&nbsp;            //unlock parent nodes in multiplayer.
<b class="nc">&nbsp;            TechNode parent = node.parent;</b>
<b class="nc">&nbsp;            while(parent != null){</b>
<b class="nc">&nbsp;                parent.content.unlock();</b>
<b class="nc">&nbsp;                parent = parent.parent;</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            checkNodes(root);</b>
<b class="nc">&nbsp;            hoverNode = null;</b>
<b class="nc">&nbsp;            treeLayout();</b>
<b class="nc">&nbsp;            rebuild();</b>
<b class="nc">&nbsp;            Core.scene.act();</b>
<b class="nc">&nbsp;            Sounds.unlock.play();</b>
<b class="nc">&nbsp;            Events.fire(new ResearchEvent(node.content));</b>
&nbsp;        }
&nbsp;
&nbsp;        void rebuild(){
<b class="nc">&nbsp;            rebuild(null);</b>
&nbsp;        }
&nbsp;
&nbsp;        //pass an array of stack indexes that should shine here
&nbsp;        void rebuild(@Nullable boolean[] shine){
<b class="nc">&nbsp;            ImageButton button = hoverNode;</b>
&nbsp;
<b class="nc">&nbsp;            infoTable.remove();</b>
<b class="nc">&nbsp;            infoTable.clear();</b>
<b class="nc">&nbsp;            infoTable.update(null);</b>
&nbsp;
<b class="nc">&nbsp;            if(button == null) return;</b>
&nbsp;
<b class="nc">&nbsp;            TechNode node = (TechNode)button.userObject;</b>
&nbsp;
<b class="nc">&nbsp;            infoTable.exited(() -&gt; {</b>
<b class="nc">&nbsp;                if(hoverNode == button &amp;&amp; !infoTable.hasMouse() &amp;&amp; !hoverNode.hasMouse()){</b>
<b class="nc">&nbsp;                    hoverNode = null;</b>
<b class="nc">&nbsp;                    rebuild();</b>
&nbsp;                }
&nbsp;            });
&nbsp;
<b class="nc">&nbsp;            infoTable.update(() -&gt; infoTable.setPosition(button.x + button.getWidth(), button.y + button.getHeight(), Align.topLeft));</b>
&nbsp;
<b class="nc">&nbsp;            infoTable.left();</b>
<b class="nc">&nbsp;            infoTable.background(Tex.button).margin(8f);</b>
&nbsp;
<b class="nc">&nbsp;            boolean selectable = selectable(node);</b>
&nbsp;
<b class="nc">&nbsp;            infoTable.table(b -&gt; {</b>
<b class="nc">&nbsp;                b.margin(0).left().defaults().left();</b>
&nbsp;
<b class="nc">&nbsp;                if(selectable){</b>
<b class="nc">&nbsp;                    b.button(Icon.info, Styles.flati, () -&gt; ui.content.show(node.content)).growY().width(50f);</b>
&nbsp;                }
<b class="nc">&nbsp;                b.add().grow();</b>
<b class="nc">&nbsp;                b.table(desc -&gt; {</b>
<b class="nc">&nbsp;                    desc.left().defaults().left();</b>
<b class="nc">&nbsp;                    desc.add(selectable ? node.content.localizedName : &quot;[accent]???&quot;);</b>
<b class="nc">&nbsp;                    desc.row();</b>
<b class="nc">&nbsp;                    if(locked(node) || debugShowRequirements){</b>
&nbsp;
<b class="nc">&nbsp;                        desc.table(t -&gt; {</b>
<b class="nc">&nbsp;                            t.left();</b>
<b class="nc">&nbsp;                            if(selectable){</b>
&nbsp;
&nbsp;                                //check if there is any progress, add research progress text
<b class="nc">&nbsp;                                if(Structs.contains(node.finishedRequirements, s -&gt; s.amount &gt; 0)){</b>
<b class="nc">&nbsp;                                    float sum = 0f, used = 0f;</b>
<b class="nc">&nbsp;                                    boolean shiny = false;</b>
&nbsp;
<b class="nc">&nbsp;                                    for(int i = 0; i &lt; node.requirements.length; i++){</b>
<b class="nc">&nbsp;                                        sum += node.requirements[i].item.cost * node.requirements[i].amount;</b>
<b class="nc">&nbsp;                                        used += node.finishedRequirements[i].item.cost * node.finishedRequirements[i].amount;</b>
<b class="nc">&nbsp;                                        if(shine != null) shiny |= shine[i];</b>
&nbsp;                                    }
&nbsp;
<b class="nc">&nbsp;                                    Label label = t.add(Core.bundle.format(&quot;research.progress&quot;, Math.min((int)(used / sum * 100), 99))).left().get();</b>
&nbsp;
<b class="nc">&nbsp;                                    if(shiny){</b>
<b class="nc">&nbsp;                                        label.setColor(Pal.accent);</b>
<b class="nc">&nbsp;                                        label.actions(Actions.color(Color.lightGray, 0.75f, Interp.fade));</b>
&nbsp;                                    }else{
<b class="nc">&nbsp;                                        label.setColor(Color.lightGray);</b>
&nbsp;                                    }
&nbsp;
<b class="nc">&nbsp;                                    t.row();</b>
&nbsp;                                }
&nbsp;
<b class="nc">&nbsp;                                for(int i = 0; i &lt; node.requirements.length; i++){</b>
<b class="nc">&nbsp;                                    ItemStack req = node.requirements[i];</b>
<b class="nc">&nbsp;                                    ItemStack completed = node.finishedRequirements[i];</b>
&nbsp;
&nbsp;                                    //skip finished stacks
<b class="nc">&nbsp;                                    if(req.amount &lt;= completed.amount &amp;&amp; !debugShowRequirements) continue;</b>
<b class="nc">&nbsp;                                    boolean shiny = shine != null &amp;&amp; shine[i];</b>
&nbsp;
<b class="nc">&nbsp;                                    t.table(list -&gt; {</b>
<b class="nc">&nbsp;                                        int reqAmount = debugShowRequirements ? req.amount : req.amount - completed.amount;</b>
&nbsp;
<b class="nc">&nbsp;                                        list.left();</b>
<b class="nc">&nbsp;                                        list.image(req.item.uiIcon).size(8 * 3).padRight(3);</b>
<b class="nc">&nbsp;                                        list.add(req.item.localizedName).color(Color.lightGray);</b>
<b class="nc">&nbsp;                                        Label label = list.label(() -&gt; &quot; &quot; +</b>
<b class="nc">&nbsp;                                                UI.formatAmount(Math.min(items.get(req.item), reqAmount)) + &quot; / &quot;</b>
<b class="nc">&nbsp;                                            + UI.formatAmount(reqAmount)).get();</b>
&nbsp;
<b class="nc">&nbsp;                                        Color targetColor = items.has(req.item) ? Color.lightGray : Color.scarlet;</b>
&nbsp;
<b class="nc">&nbsp;                                        if(shiny){</b>
<b class="nc">&nbsp;                                            label.setColor(Pal.accent);</b>
<b class="nc">&nbsp;                                            label.actions(Actions.color(targetColor, 0.75f, Interp.fade));</b>
&nbsp;                                        }else{
<b class="nc">&nbsp;                                            label.setColor(targetColor);</b>
&nbsp;                                        }
&nbsp;
<b class="nc">&nbsp;                                    }).fillX().left();</b>
<b class="nc">&nbsp;                                    t.row();</b>
&nbsp;                                }
<b class="nc">&nbsp;                            }else if(node.objectives.size &gt; 0){</b>
<b class="nc">&nbsp;                                t.table(r -&gt; {</b>
<b class="nc">&nbsp;                                    r.add(&quot;@complete&quot;).colspan(2).left();</b>
<b class="nc">&nbsp;                                    r.row();</b>
<b class="nc">&nbsp;                                    for(Objective o : node.objectives){</b>
<b class="nc">&nbsp;                                        if(o.complete()) continue;</b>
&nbsp;
<b class="nc">&nbsp;                                        r.add(&quot;&gt; &quot; + o.display()).color(Color.lightGray).left();</b>
<b class="nc">&nbsp;                                        r.image(o.complete() ? Icon.ok : Icon.cancel, o.complete() ? Color.lightGray : Color.scarlet).padLeft(3);</b>
<b class="nc">&nbsp;                                        r.row();</b>
<b class="nc">&nbsp;                                    }</b>
&nbsp;                                });
<b class="nc">&nbsp;                                t.row();</b>
&nbsp;                            }
&nbsp;                        });
&nbsp;                    }else{
<b class="nc">&nbsp;                        desc.add(&quot;@completed&quot;);</b>
&nbsp;                    }
<b class="nc">&nbsp;                }).pad(9);</b>
&nbsp;
<b class="nc">&nbsp;                if(mobile &amp;&amp; locked(node)){</b>
<b class="nc">&nbsp;                    b.row();</b>
<b class="nc">&nbsp;                    b.button(&quot;@research&quot;, Icon.ok, new TextButtonStyle(){{</b>
<b class="nc">&nbsp;                        disabled = Tex.button;</b>
<b class="nc">&nbsp;                        font = Fonts.def;</b>
<b class="nc">&nbsp;                        fontColor = Color.white;</b>
<b class="nc">&nbsp;                        disabledFontColor = Color.gray;</b>
<b class="nc">&nbsp;                        up = buttonOver;</b>
<b class="nc">&nbsp;                        over = buttonDown;</b>
<b class="nc">&nbsp;                    }}, () -&gt; spend(node)).disabled(i -&gt; !canSpend(node)).growX().height(44f).colspan(3);</b>
&nbsp;                }
&nbsp;            });
&nbsp;
<b class="nc">&nbsp;            infoTable.row();</b>
<b class="nc">&nbsp;            if(node.content.description != null &amp;&amp; node.content.inlineDescription &amp;&amp; selectable){</b>
<b class="nc">&nbsp;                infoTable.table(t -&gt; t.margin(3f).left().labelWrap(node.content.displayDescription()).color(Color.lightGray).growX()).fillX();</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            addChild(infoTable);</b>
&nbsp;
<b class="nc">&nbsp;            checkMargin();</b>
<b class="nc">&nbsp;            Core.app.post(() -&gt; checkMargin());</b>
&nbsp;
<b class="nc">&nbsp;            infoTable.pack();</b>
<b class="nc">&nbsp;            infoTable.act(Core.graphics.getDeltaTime());</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public void drawChildren(){
<b class="nc">&nbsp;            clamp();</b>
<b class="nc">&nbsp;            float offsetX = panX + width / 2f, offsetY = panY + height / 2f;</b>
<b class="nc">&nbsp;            Draw.sort(true);</b>
&nbsp;
<b class="nc">&nbsp;            for(TechTreeNode node : nodes){</b>
<b class="nc">&nbsp;                if(!node.visible) continue;</b>
<b class="nc">&nbsp;                for(TechTreeNode child : node.children){</b>
<b class="nc">&nbsp;                    if(!child.visible) continue;</b>
<b class="nc">&nbsp;                    boolean lock = locked(node.node) || locked(child.node);</b>
<b class="nc">&nbsp;                    Draw.z(lock ? 1f : 2f);</b>
&nbsp;
<b class="nc">&nbsp;                    Lines.stroke(Scl.scl(4f), lock ? Pal.gray : Pal.accent);</b>
<b class="nc">&nbsp;                    Draw.alpha(parentAlpha);</b>
<b class="nc">&nbsp;                    if(Mathf.equal(Math.abs(node.y - child.y), Math.abs(node.x - child.x), 1f) &amp;&amp; Mathf.dstm(node.x, node.y, child.x, child.y) &lt;= node.width*3){</b>
<b class="nc">&nbsp;                        Lines.line(node.x + offsetX, node.y + offsetY, child.x + offsetX, child.y + offsetY);</b>
&nbsp;                    }else{
<b class="nc">&nbsp;                        Lines.line(node.x + offsetX, node.y + offsetY, child.x + offsetX, node.y + offsetY);</b>
<b class="nc">&nbsp;                        Lines.line(child.x + offsetX, node.y + offsetY, child.x + offsetX, child.y + offsetY);</b>
&nbsp;                    }
&nbsp;                }
<b class="nc">&nbsp;            }</b>
&nbsp;
<b class="nc">&nbsp;            Draw.sort(false);</b>
<b class="nc">&nbsp;            Draw.reset();</b>
<b class="nc">&nbsp;            super.drawChildren();</b>
&nbsp;        }
&nbsp;    }
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2024-10-10 15:59</div>
</div>
</body>
</html>
