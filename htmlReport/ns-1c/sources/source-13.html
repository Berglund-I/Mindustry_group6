


<!DOCTYPE html>
<html id="htmlId">
<head>
  <title>Coverage Report > Shaders</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">mindustry.graphics</a>
</div>

<h1>Coverage Summary for Class: Shaders (mindustry.graphics)</h1>

<table class="coverageStats">

<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">Shaders</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/29)
  </span>
</td>
</tr>
  <tr>
    <td class="name">Shaders$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">Shaders$AtmosphereShader</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/13)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">Shaders$BlockBuildShader</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/11)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">Shaders$BuildBeamShader</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/6)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">Shaders$CloudShader</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/9)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">Shaders$DarknessShader</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">Shaders$FogShader</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">Shaders$LightShader</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">Shaders$LoadShader</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">Shaders$MeshShader</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">Shaders$PlanetGridShader</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">Shaders$PlanetShader</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/10)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">Shaders$ShieldShader</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/6)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">Shaders$ShockwaveShader</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/7)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/50)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">Shaders$SpaceShader</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/12)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">Shaders$SurfaceShader</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/6)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/17)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">Shaders$UnitArmorShader</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/6)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">Shaders$UnitBuildShader</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/8)
  </span>
</td>
  </tr>
<tr>
  <td class="name"><strong>Total</strong></td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/45)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/189)
  </span>
</td>
</tr>
</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;package mindustry.graphics;
&nbsp;
&nbsp;import arc.*;
&nbsp;import arc.files.*;
&nbsp;import arc.graphics.*;
&nbsp;import arc.graphics.Texture.*;
&nbsp;import arc.graphics.g2d.*;
&nbsp;import arc.graphics.g3d.*;
&nbsp;import arc.graphics.gl.*;
&nbsp;import arc.math.geom.*;
&nbsp;import arc.scene.ui.layout.*;
&nbsp;import arc.struct.*;
&nbsp;import arc.util.*;
&nbsp;import mindustry.game.EventType.*;
&nbsp;import mindustry.type.*;
&nbsp;
&nbsp;import static mindustry.Vars.*;
&nbsp;
<b class="nc">&nbsp;public class Shaders{</b>
&nbsp;    public static BlockBuildShader blockbuild;
&nbsp;    public static @Nullable ShieldShader shield;
&nbsp;    public static BuildBeamShader buildBeam;
&nbsp;    public static UnitBuildShader build;
&nbsp;    public static UnitArmorShader armor;
&nbsp;    public static DarknessShader darkness;
&nbsp;    public static FogShader fog;
&nbsp;    public static LightShader light;
&nbsp;    public static SurfaceShader water, mud, tar, slag, cryofluid, space, caustics, arkycite;
&nbsp;    public static PlanetShader planet;
&nbsp;    public static CloudShader clouds;
&nbsp;    public static PlanetGridShader planetGrid;
&nbsp;    public static AtmosphereShader atmosphere;
&nbsp;    public static ShockwaveShader shockwave;
&nbsp;    public static MeshShader mesh;
&nbsp;    public static Shader unlit;
&nbsp;    public static Shader screenspace;
&nbsp;
&nbsp;    public static void init(){
<b class="nc">&nbsp;        mesh = new MeshShader();</b>
<b class="nc">&nbsp;        blockbuild = new BlockBuildShader();</b>
&nbsp;        try{
<b class="nc">&nbsp;            shield = new ShieldShader();</b>
<b class="nc">&nbsp;        }catch(Throwable t){</b>
&nbsp;            //don&#39;t load shield shader
<b class="nc">&nbsp;            shield = null;</b>
<b class="nc">&nbsp;            t.printStackTrace();</b>
<b class="nc">&nbsp;        }</b>
<b class="nc">&nbsp;        fog = new FogShader();</b>
<b class="nc">&nbsp;        buildBeam = new BuildBeamShader();</b>
<b class="nc">&nbsp;        build = new UnitBuildShader();</b>
<b class="nc">&nbsp;        armor = new UnitArmorShader();</b>
<b class="nc">&nbsp;        darkness = new DarknessShader();</b>
<b class="nc">&nbsp;        light = new LightShader();</b>
<b class="nc">&nbsp;        water = new SurfaceShader(&quot;water&quot;);</b>
<b class="nc">&nbsp;        arkycite = new SurfaceShader(&quot;arkycite&quot;);</b>
<b class="nc">&nbsp;        mud = new SurfaceShader(&quot;mud&quot;);</b>
<b class="nc">&nbsp;        tar = new SurfaceShader(&quot;tar&quot;);</b>
<b class="nc">&nbsp;        slag = new SurfaceShader(&quot;slag&quot;);</b>
<b class="nc">&nbsp;        cryofluid = new SurfaceShader(&quot;cryofluid&quot;);</b>
<b class="nc">&nbsp;        space = new SpaceShader(&quot;space&quot;);</b>
<b class="nc">&nbsp;        caustics = new SurfaceShader(&quot;caustics&quot;){</b>
&nbsp;            @Override
&nbsp;            public String textureName(){
<b class="nc">&nbsp;                return &quot;caustics&quot;;</b>
&nbsp;            }
&nbsp;        };
<b class="nc">&nbsp;        planet = new PlanetShader();</b>
<b class="nc">&nbsp;        clouds = new CloudShader();</b>
<b class="nc">&nbsp;        planetGrid = new PlanetGridShader();</b>
<b class="nc">&nbsp;        atmosphere = new AtmosphereShader();</b>
<b class="nc">&nbsp;        unlit = new LoadShader(&quot;planet&quot;, &quot;unlit&quot;);</b>
<b class="nc">&nbsp;        screenspace = new LoadShader(&quot;screenspace&quot;, &quot;screenspace&quot;);</b>
&nbsp;
&nbsp;        //disabled for now...
&nbsp;        //shockwave = new ShockwaveShader();
&nbsp;    }
&nbsp;
&nbsp;    public static class AtmosphereShader extends LoadShader{
&nbsp;        public Camera3D camera;
&nbsp;        public Planet planet;
&nbsp;
<b class="nc">&nbsp;        Mat3D mat = new Mat3D();</b>
&nbsp;
&nbsp;        public AtmosphereShader(){
<b class="nc">&nbsp;            super(&quot;atmosphere&quot;, &quot;atmosphere&quot;);</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public void apply(){
<b class="nc">&nbsp;            setUniformf(&quot;u_resolution&quot;, Core.graphics.getWidth(), Core.graphics.getHeight());</b>
&nbsp;
<b class="nc">&nbsp;            setUniformf(&quot;u_time&quot;, Time.globalTime / 10f);</b>
<b class="nc">&nbsp;            setUniformf(&quot;u_campos&quot;, camera.position);</b>
<b class="nc">&nbsp;            setUniformf(&quot;u_rcampos&quot;, Tmp.v31.set(camera.position).sub(planet.position));</b>
<b class="nc">&nbsp;            setUniformf(&quot;u_light&quot;, planet.getLightNormal());</b>
<b class="nc">&nbsp;            setUniformf(&quot;u_color&quot;, planet.atmosphereColor.r, planet.atmosphereColor.g, planet.atmosphereColor.b);</b>
<b class="nc">&nbsp;            setUniformf(&quot;u_innerRadius&quot;, planet.radius + planet.atmosphereRadIn);</b>
<b class="nc">&nbsp;            setUniformf(&quot;u_outerRadius&quot;, planet.radius + planet.atmosphereRadOut);</b>
&nbsp;
<b class="nc">&nbsp;            setUniformMatrix4(&quot;u_model&quot;, planet.getTransform(mat).val);</b>
<b class="nc">&nbsp;            setUniformMatrix4(&quot;u_projection&quot;, camera.combined.val);</b>
<b class="nc">&nbsp;            setUniformMatrix4(&quot;u_invproj&quot;, camera.invProjectionView.val);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    public static class PlanetShader extends LoadShader{
<b class="nc">&nbsp;        public Vec3 lightDir = new Vec3(1, 1, 1).nor();</b>
<b class="nc">&nbsp;        public Color ambientColor = Color.white.cpy();</b>
<b class="nc">&nbsp;        public Vec3 camDir = new Vec3();</b>
<b class="nc">&nbsp;        public Vec3 camPos = new Vec3();</b>
&nbsp;        public Planet planet;
&nbsp;
&nbsp;        public PlanetShader(){
<b class="nc">&nbsp;            super(&quot;planet&quot;, &quot;planet&quot;);</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public void apply(){
<b class="nc">&nbsp;            camDir.set(renderer.planets.cam.direction).rotate(Vec3.Y, planet.getRotation());</b>
&nbsp;
<b class="nc">&nbsp;            setUniformf(&quot;u_lightdir&quot;, lightDir);</b>
<b class="nc">&nbsp;            setUniformf(&quot;u_ambientColor&quot;, ambientColor.r, ambientColor.g, ambientColor.b);</b>
<b class="nc">&nbsp;            setUniformf(&quot;u_camdir&quot;, camDir);</b>
<b class="nc">&nbsp;            setUniformf(&quot;u_campos&quot;, renderer.planets.cam.position);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    public static class CloudShader extends LoadShader{
<b class="nc">&nbsp;        public Vec3 lightDir = new Vec3(1, 1, 1).nor();</b>
<b class="nc">&nbsp;        public Color ambientColor = Color.white.cpy();</b>
<b class="nc">&nbsp;        public Vec3 camDir = new Vec3();</b>
<b class="nc">&nbsp;        public float alpha = 1f;</b>
&nbsp;        public Planet planet;
&nbsp;
&nbsp;        public CloudShader(){
<b class="nc">&nbsp;            super(&quot;planet&quot;, &quot;clouds&quot;);</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public void apply(){
<b class="nc">&nbsp;            camDir.set(renderer.planets.cam.direction).rotate(Vec3.Y, planet.getRotation());</b>
&nbsp;
<b class="nc">&nbsp;            setUniformf(&quot;u_alpha&quot;, alpha);</b>
<b class="nc">&nbsp;            setUniformf(&quot;u_lightdir&quot;, lightDir);</b>
<b class="nc">&nbsp;            setUniformf(&quot;u_ambientColor&quot;, ambientColor.r, ambientColor.g, ambientColor.b);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    public static class MeshShader extends LoadShader{
&nbsp;
&nbsp;        public MeshShader(){
<b class="nc">&nbsp;            super(&quot;planet&quot;, &quot;mesh&quot;);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    public static class PlanetGridShader extends LoadShader{
<b class="nc">&nbsp;        public Vec3 mouse = new Vec3();</b>
&nbsp;
&nbsp;        public PlanetGridShader(){
<b class="nc">&nbsp;            super(&quot;planetgrid&quot;, &quot;planetgrid&quot;);</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public void apply(){
<b class="nc">&nbsp;            setUniformf(&quot;u_mouse&quot;, mouse);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    public static class LightShader extends LoadShader{
<b class="nc">&nbsp;        public Color ambient = new Color(0.01f, 0.01f, 0.04f, 0.99f);</b>
&nbsp;
&nbsp;        public LightShader(){
<b class="nc">&nbsp;            super(&quot;light&quot;, &quot;screenspace&quot;);</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public void apply(){
<b class="nc">&nbsp;            setUniformf(&quot;u_ambient&quot;, ambient);</b>
&nbsp;        }
&nbsp;
&nbsp;    }
&nbsp;
&nbsp;    public static class DarknessShader extends LoadShader{
&nbsp;        public DarknessShader(){
<b class="nc">&nbsp;            super(&quot;darkness&quot;, &quot;default&quot;);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    public static class FogShader extends LoadShader{
&nbsp;        public FogShader(){
<b class="nc">&nbsp;            super(&quot;fog&quot;, &quot;default&quot;);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    public static class UnitBuildShader extends LoadShader{
&nbsp;        public float progress, time;
<b class="nc">&nbsp;        public Color color = new Color();</b>
&nbsp;        public TextureRegion region;
&nbsp;
&nbsp;        public UnitBuildShader(){
<b class="nc">&nbsp;            super(&quot;unitbuild&quot;, &quot;default&quot;);</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public void apply(){
<b class="nc">&nbsp;            setUniformf(&quot;u_time&quot;, time);</b>
<b class="nc">&nbsp;            setUniformf(&quot;u_color&quot;, color);</b>
<b class="nc">&nbsp;            setUniformf(&quot;u_progress&quot;, progress);</b>
<b class="nc">&nbsp;            setUniformf(&quot;u_uv&quot;, region.u, region.v);</b>
<b class="nc">&nbsp;            setUniformf(&quot;u_uv2&quot;, region.u2, region.v2);</b>
<b class="nc">&nbsp;            setUniformf(&quot;u_texsize&quot;, region.texture.width, region.texture.height);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    public static class UnitArmorShader extends LoadShader{
&nbsp;        public float progress, time;
&nbsp;        public TextureRegion region;
&nbsp;
&nbsp;        public UnitArmorShader(){
<b class="nc">&nbsp;            super(&quot;unitarmor&quot;, &quot;default&quot;);</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public void apply(){
<b class="nc">&nbsp;            setUniformf(&quot;u_time&quot;, time);</b>
<b class="nc">&nbsp;            setUniformf(&quot;u_progress&quot;, progress);</b>
<b class="nc">&nbsp;            setUniformf(&quot;u_uv&quot;, region.u, region.v);</b>
<b class="nc">&nbsp;            setUniformf(&quot;u_uv2&quot;, region.u2, region.v2);</b>
<b class="nc">&nbsp;            setUniformf(&quot;u_texsize&quot;, region.texture.width, region.texture.height);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    public static class BlockBuildShader extends LoadShader{
&nbsp;        public float progress;
<b class="nc">&nbsp;        public TextureRegion region = new TextureRegion();</b>
&nbsp;        public float time;
&nbsp;
&nbsp;        public BlockBuildShader(){
<b class="nc">&nbsp;            super(&quot;blockbuild&quot;, &quot;default&quot;);</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public void apply(){
<b class="nc">&nbsp;            setUniformf(&quot;u_progress&quot;, progress);</b>
<b class="nc">&nbsp;            setUniformf(&quot;u_time&quot;, time);</b>
&nbsp;
<b class="nc">&nbsp;            if(region.texture == null){</b>
<b class="nc">&nbsp;                setUniformf(&quot;u_uv&quot;, 0f, 0f);</b>
<b class="nc">&nbsp;                setUniformf(&quot;u_uv2&quot;, 1f, 1f);</b>
<b class="nc">&nbsp;                setUniformf(&quot;u_texsize&quot;, 1, 1);</b>
&nbsp;            }else{
<b class="nc">&nbsp;                setUniformf(&quot;u_uv&quot;, region.u, region.v);</b>
<b class="nc">&nbsp;                setUniformf(&quot;u_uv2&quot;, region.u2, region.v2);</b>
<b class="nc">&nbsp;                setUniformf(&quot;u_texsize&quot;, region.texture.width, region.texture.height);</b>
&nbsp;            }
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    public static class ShieldShader extends LoadShader{
&nbsp;
&nbsp;        public ShieldShader(){
<b class="nc">&nbsp;            super(&quot;shield&quot;, &quot;screenspace&quot;);</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public void apply(){
<b class="nc">&nbsp;            setUniformf(&quot;u_dp&quot;, Scl.scl(1f));</b>
<b class="nc">&nbsp;            setUniformf(&quot;u_time&quot;, Time.time / Scl.scl(1f));</b>
<b class="nc">&nbsp;            setUniformf(&quot;u_offset&quot;,</b>
&nbsp;                Core.camera.position.x - Core.camera.width / 2,
&nbsp;                Core.camera.position.y - Core.camera.height / 2);
<b class="nc">&nbsp;            setUniformf(&quot;u_texsize&quot;, Core.camera.width, Core.camera.height);</b>
<b class="nc">&nbsp;            setUniformf(&quot;u_invsize&quot;, 1f/Core.camera.width, 1f/Core.camera.height);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    public static class BuildBeamShader extends LoadShader{
&nbsp;
&nbsp;        public BuildBeamShader(){
<b class="nc">&nbsp;            super(&quot;buildbeam&quot;, &quot;screenspace&quot;);</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public void apply(){
<b class="nc">&nbsp;            setUniformf(&quot;u_dp&quot;, Scl.scl(1f));</b>
<b class="nc">&nbsp;            setUniformf(&quot;u_time&quot;, Time.time / Scl.scl(1f));</b>
<b class="nc">&nbsp;            setUniformf(&quot;u_offset&quot;,</b>
&nbsp;            Core.camera.position.x - Core.camera.width / 2,
&nbsp;            Core.camera.position.y - Core.camera.height / 2);
<b class="nc">&nbsp;            setUniformf(&quot;u_texsize&quot;, Core.camera.width, Core.camera.height);</b>
<b class="nc">&nbsp;            setUniformf(&quot;u_invsize&quot;, 1f/Core.camera.width, 1f/Core.camera.height);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    //seed: 8kmfuix03fw
&nbsp;    public static class SpaceShader extends SurfaceShader{
&nbsp;        Texture texture;
&nbsp;
&nbsp;        public SpaceShader(String frag){
<b class="nc">&nbsp;            super(frag);</b>
&nbsp;
<b class="nc">&nbsp;            Core.assets.load(&quot;sprites/space.png&quot;, Texture.class).loaded = t -&gt; {</b>
<b class="nc">&nbsp;                texture = t;</b>
<b class="nc">&nbsp;                texture.setFilter(TextureFilter.linear);</b>
<b class="nc">&nbsp;                texture.setWrap(TextureWrap.mirroredRepeat);</b>
&nbsp;            };
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public void apply(){
<b class="nc">&nbsp;            setUniformf(&quot;u_campos&quot;, Core.camera.position.x, Core.camera.position.y);</b>
<b class="nc">&nbsp;            setUniformf(&quot;u_ccampos&quot;, Core.camera.position);</b>
<b class="nc">&nbsp;            setUniformf(&quot;u_resolution&quot;, Core.graphics.getWidth(), Core.graphics.getHeight());</b>
<b class="nc">&nbsp;            setUniformf(&quot;u_time&quot;, Time.time);</b>
&nbsp;
<b class="nc">&nbsp;            texture.bind(1);</b>
<b class="nc">&nbsp;            renderer.effectBuffer.getTexture().bind(0);</b>
&nbsp;
<b class="nc">&nbsp;            setUniformi(&quot;u_stars&quot;, 1);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    public static class SurfaceShader extends Shader{
&nbsp;        Texture noiseTex;
&nbsp;
&nbsp;        public SurfaceShader(String frag){
<b class="nc">&nbsp;            super(getShaderFi(&quot;screenspace.vert&quot;), getShaderFi(frag + &quot;.frag&quot;));</b>
<b class="nc">&nbsp;            loadNoise();</b>
&nbsp;        }
&nbsp;
&nbsp;        public SurfaceShader(String vertRaw, String fragRaw){
<b class="nc">&nbsp;            super(vertRaw, fragRaw);</b>
<b class="nc">&nbsp;            loadNoise();</b>
&nbsp;        }
&nbsp;
&nbsp;        public String textureName(){
<b class="nc">&nbsp;            return &quot;noise&quot;;</b>
&nbsp;        }
&nbsp;
&nbsp;        public void loadNoise(){
<b class="nc">&nbsp;            Core.assets.load(&quot;sprites/&quot; + textureName() + &quot;.png&quot;, Texture.class).loaded = t -&gt; {</b>
<b class="nc">&nbsp;                t.setFilter(TextureFilter.linear);</b>
<b class="nc">&nbsp;                t.setWrap(TextureWrap.repeat);</b>
&nbsp;            };
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public void apply(){
<b class="nc">&nbsp;            setUniformf(&quot;u_campos&quot;, Core.camera.position.x - Core.camera.width / 2, Core.camera.position.y - Core.camera.height / 2);</b>
<b class="nc">&nbsp;            setUniformf(&quot;u_resolution&quot;, Core.camera.width, Core.camera.height);</b>
<b class="nc">&nbsp;            setUniformf(&quot;u_time&quot;, Time.time);</b>
&nbsp;
<b class="nc">&nbsp;            if(hasUniform(&quot;u_noise&quot;)){</b>
<b class="nc">&nbsp;                if(noiseTex == null){</b>
<b class="nc">&nbsp;                    noiseTex = Core.assets.get(&quot;sprites/&quot; + textureName() + &quot;.png&quot;, Texture.class);</b>
&nbsp;                }
&nbsp;
<b class="nc">&nbsp;                noiseTex.bind(1);</b>
<b class="nc">&nbsp;                renderer.effectBuffer.getTexture().bind(0);</b>
&nbsp;
<b class="nc">&nbsp;                setUniformi(&quot;u_noise&quot;, 1);</b>
&nbsp;            }
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    public static class ShockwaveShader extends LoadShader{
&nbsp;        static final int max = 64;
&nbsp;        static final int size = 5;
&nbsp;
&nbsp;        //x y radius life[1-0] lifetime
<b class="nc">&nbsp;        protected FloatSeq data = new FloatSeq();</b>
<b class="nc">&nbsp;        protected FloatSeq uniforms = new FloatSeq();</b>
<b class="nc">&nbsp;        protected boolean hadAny = false;</b>
<b class="nc">&nbsp;        protected FrameBuffer buffer = new FrameBuffer();</b>
&nbsp;
<b class="nc">&nbsp;        public float lifetime = 20f;</b>
&nbsp;
&nbsp;        public ShockwaveShader(){
<b class="nc">&nbsp;            super(&quot;shockwave&quot;, &quot;screenspace&quot;);</b>
&nbsp;
<b class="nc">&nbsp;            Events.run(Trigger.update, () -&gt; {</b>
<b class="nc">&nbsp;                if(state.isPaused()) return;</b>
<b class="nc">&nbsp;                if(state.isMenu()){</b>
<b class="nc">&nbsp;                    data.size = 0;</b>
&nbsp;                    return;
&nbsp;                }
&nbsp;
<b class="nc">&nbsp;                var items = data.items;</b>
<b class="nc">&nbsp;                for(int i = 0; i &lt; data.size; i += size){</b>
&nbsp;                    //decrease lifetime
<b class="nc">&nbsp;                    items[i + 3] -= Time.delta / items[i + 4];</b>
&nbsp;
<b class="nc">&nbsp;                    if(items[i + 3] &lt;= 0f){</b>
&nbsp;                        //swap with head.
<b class="nc">&nbsp;                        if(data.size &gt; size){</b>
<b class="nc">&nbsp;                            System.arraycopy(items, data.size - size, items, i, size);</b>
&nbsp;                        }
&nbsp;
<b class="nc">&nbsp;                        data.size -= size;</b>
<b class="nc">&nbsp;                        i -= size;</b>
&nbsp;                    }
&nbsp;                }
&nbsp;            });
&nbsp;
<b class="nc">&nbsp;            Events.run(Trigger.preDraw, () -&gt; {</b>
<b class="nc">&nbsp;                hadAny = data.size &gt; 0;</b>
&nbsp;
<b class="nc">&nbsp;                if(hadAny){</b>
<b class="nc">&nbsp;                    buffer.resize(Core.graphics.getWidth(), Core.graphics.getHeight());</b>
<b class="nc">&nbsp;                    buffer.begin(Color.clear);</b>
&nbsp;                }
&nbsp;            });
&nbsp;
<b class="nc">&nbsp;            Events.run(Trigger.postDraw, () -&gt; {</b>
<b class="nc">&nbsp;                if(hadAny){</b>
<b class="nc">&nbsp;                    buffer.end();</b>
<b class="nc">&nbsp;                    Draw.blend(Blending.disabled);</b>
<b class="nc">&nbsp;                    buffer.blit(this);</b>
<b class="nc">&nbsp;                    Draw.blend();</b>
&nbsp;                }
&nbsp;            });
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public void apply(){
<b class="nc">&nbsp;            int count = data.size / size;</b>
&nbsp;
<b class="nc">&nbsp;            setUniformi(&quot;u_shockwave_count&quot;, count);</b>
<b class="nc">&nbsp;            if(count &gt; 0){</b>
<b class="nc">&nbsp;                setUniformf(&quot;u_resolution&quot;, Core.camera.width, Core.camera.height);</b>
<b class="nc">&nbsp;                setUniformf(&quot;u_campos&quot;, Core.camera.position.x - Core.camera.width/2f, Core.camera.position.y - Core.camera.height/2f);</b>
&nbsp;
<b class="nc">&nbsp;                uniforms.clear();</b>
&nbsp;
<b class="nc">&nbsp;                var items = data.items;</b>
<b class="nc">&nbsp;                for(int i = 0; i &lt; count; i++){</b>
<b class="nc">&nbsp;                    int offset = i * size;</b>
&nbsp;
<b class="nc">&nbsp;                    uniforms.add(</b>
&nbsp;                    items[offset], items[offset + 1], //xy
&nbsp;                    items[offset + 2] * (1f - items[offset + 3]), //radius * time
&nbsp;                    items[offset + 3] //time
&nbsp;                    //lifetime ignored
&nbsp;                    );
&nbsp;                }
&nbsp;
<b class="nc">&nbsp;                setUniform4fv(&quot;u_shockwaves&quot;, uniforms.items, 0, uniforms.size);</b>
&nbsp;            }
&nbsp;        }
&nbsp;
&nbsp;        public void add(float x, float y, float radius){
<b class="nc">&nbsp;            add(x, y, radius, 20f);</b>
&nbsp;        }
&nbsp;
&nbsp;        public void add(float x, float y, float radius, float lifetime){
&nbsp;            //replace first entry
<b class="nc">&nbsp;            if(data.size / size &gt;= max){</b>
<b class="nc">&nbsp;                var items = data.items;</b>
<b class="nc">&nbsp;                items[0] = x;</b>
<b class="nc">&nbsp;                items[1] = y;</b>
<b class="nc">&nbsp;                items[2] = radius;</b>
<b class="nc">&nbsp;                items[3] = 1f;</b>
<b class="nc">&nbsp;                items[4] = lifetime;</b>
<b class="nc">&nbsp;            }else{</b>
<b class="nc">&nbsp;                data.addAll(x, y, radius, 1f, lifetime);</b>
&nbsp;            }
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    public static class LoadShader extends Shader{
&nbsp;        public LoadShader(String frag, String vert){
<b class="nc">&nbsp;            super(getShaderFi(vert + &quot;.vert&quot;), getShaderFi(frag + &quot;.frag&quot;));</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    public static Fi getShaderFi(String file){
<b class="nc">&nbsp;        return tree.get(&quot;shaders/&quot; + file);</b>
&nbsp;    }
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2024-10-10 15:59</div>
</div>
</body>
</html>
